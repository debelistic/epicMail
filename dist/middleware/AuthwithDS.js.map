{"version":3,"sources":["../../server/middleware/AuthwithDS.js"],"names":["Auth","verifyToken","req","res","next","token","headers","status","send","message","decoded","jwt","verify","process","env","SECRET","UserModel","getAllusers","length","getAUserWithId","userId","id","messae"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEA,IAAMA,IAAI,GAAG;AACXC,EAAAA,WADW,uBACCC,GADD,EACMC,GADN,EACWC,IADX,EACiB;AAC1B,QAAMC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAY,gBAAZ,CAAd;;AAEA,QAAI,CAACD,KAAL,EAAY;AACV,aAAOF,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,QAAAA,OAAO,EAAE;AAAX,OAArB,CAAP;AACD;;AAED,QAAMC,OAAO,GAAGC,sBAAIC,MAAJ,CAAWP,KAAX,EAAkBQ,OAAO,CAACC,GAAR,CAAYC,MAA9B,CAAhB;;AACA,QAAIC,cAAUC,WAAV,GAAwBC,MAAxB,KAAmC,CAAvC,EAA0C;AACxC,aAAOf,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,QAAAA,OAAO,EAAE;AAAX,OAArB,CAAP;AACD;;AAED,QAAI,CAACO,cAAUG,cAAV,CAAyBT,OAAO,CAACU,MAAR,CAAeC,EAAxC,CAAL,EAAkD;AAChD,aAAOlB,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEc,QAAAA,MAAM,EAAE;AAAV,OAArB,CAAP;AACD;;AACD,WAAOlB,IAAI,EAAX;AACD;AAjBU,CAAb;eAqBeJ,I","sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport UserModel from '../models/User';\r\n\r\nconst Auth = {\r\n  verifyToken(req, res, next) {\r\n    const token = req.headers['x-access-token'];\r\n\r\n    if (!token) {\r\n      return res.status(403).send({ message: 'No Token Provided' });\r\n    }\r\n\r\n    const decoded = jwt.verify(token, process.env.SECRET);\r\n    if (UserModel.getAllusers().length === 0) {\r\n      return res.status(403).send({ message: 'Session closed' });\r\n    }\r\n\r\n    if (!UserModel.getAUserWithId(decoded.userId.id)) {\r\n      return res.status(403).send({ messae: 'User not registered' });\r\n    }\r\n    return next();\r\n  },\r\n};\r\n\r\n\r\nexport default Auth;\r\n"],"file":"AuthwithDS.js"}