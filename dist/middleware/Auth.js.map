{"version":3,"sources":["../../server/middleware/Auth.js"],"names":["Auth","verifyToken","req","res","next","token","headers","status","send","message","decoded","jwt","verify","process","env","SECRET","text","db","query","userEmail","rows","user","email","error"],"mappings":";;;;;;;AAAA;;AACA;;;;;;;;AAEA,IAAMA,IAAI,GAAG;AACLC,EAAAA,WADK;AAAA;AAAA;AAAA,6CACOC,GADP,EACYC,GADZ,EACiBC,IADjB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAEHC,cAAAA,KAFG,GAEKH,GAAG,CAACI,OAAJ,CAAY,gBAAZ,CAFL;;AAAA,kBAIJD,KAJI;AAAA;AAAA;AAAA;;AAAA,+CAKAF,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,gBAAAA,OAAO,EAAE;AAAX,eAArB,CALA;;AAAA;AAAA;AAQDC,cAAAA,OARC,GAQSC,sBAAIC,MAAJ,CAAWP,KAAX,EAAkBQ,OAAO,CAACC,GAAR,CAAYC,MAA9B,CART;AASDC,cAAAA,IATC,GASM,sCATN;AAAA;AAAA,qBAUgBC,YAAGC,KAAH,CAASF,IAAT,EAAe,CAACN,OAAO,CAACS,SAAT,CAAf,CAVhB;;AAAA;AAAA;AAUCC,cAAAA,IAVD,QAUCA,IAVD;;AAAA,kBAWFA,IAAI,CAAC,CAAD,CAXF;AAAA;AAAA;AAAA;;AAAA,+CAYEjB,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,gBAAAA,OAAO,EAAE;AAAX,eAArB,CAZF;;AAAA;AAcPP,cAAAA,GAAG,CAACmB,IAAJ,GAAW;AAAEC,gBAAAA,KAAK,EAAEZ,OAAO,CAACS;AAAjB,eAAX;AAdO,+CAeAf,IAAI,EAfJ;;AAAA;AAAA;AAAA;AAAA,+CAiBAD,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEe,gBAAAA,KAAK;AAAP,eAArB,CAjBA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,CAAb;eAsBevB,I","sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport db from '../db';\r\n\r\nconst Auth = {\r\n  async verifyToken(req, res, next) {\r\n    const token = req.headers['x-access-token'];\r\n\r\n    if (!token) {\r\n      return res.status(403).send({ message: 'No Token Provided' });\r\n    }\r\n    try {\r\n      const decoded = jwt.verify(token, process.env.SECRET);\r\n      const text = 'SELECT * FROM users WHERE email = $1';\r\n      const { rows } = await db.query(text, [decoded.userEmail]);\r\n      if (!rows[0]) {\r\n        return res.status(403).send({ message: 'Session closed' });\r\n      }\r\n      req.user = { email: decoded.userEmail };\r\n      return next();\r\n    } catch (error) {\r\n      return res.status(400).send({ error });\r\n    }\r\n  },\r\n};\r\n\r\nexport default Auth;\r\n"],"file":"Auth.js"}