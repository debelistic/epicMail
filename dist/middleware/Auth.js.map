{"version":3,"sources":["../../server/middleware/Auth.js"],"names":["Auth","verifyToken","req","res","next","token","headers","status","send","message","decoded","jwt","verify","process","env","SECRET","text","db","query","userEmail","rows","user","email","error"],"mappings":";;;;;;AAAA;;;;AACA;;;;;;;;AAEA,IAAMA,OAAO;AACLC,aADK,uBACOC,GADP,EACYC,GADZ,EACiBC,IADjB,EACuB;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAC1BC,mBAD0B,GAClBH,IAAII,OAAJ,CAAY,gBAAZ,CADkB;;AAAA,kBAG3BD,KAH2B;AAAA;AAAA;AAAA;;AAAA,+CAIvBF,IAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,mBAAX,EAArB,CAJuB;;AAAA;AAAA;AAOxBC,qBAPwB,GAOdC,uBAAIC,MAAJ,CAAWP,KAAX,EAAkBQ,QAAQC,GAAR,CAAYC,MAA9B,CAPc;AAQxBC,kBARwB,GAQjB,sCARiB;AAAA;AAAA,qBASPC,aAAGC,KAAH,CAASF,IAAT,EAAe,CAACN,QAAQS,SAAT,CAAf,CATO;;AAAA;AAAA;AAStBC,kBATsB,QAStBA,IATsB;;AAAA,kBAUzBA,KAAK,CAAL,CAVyB;AAAA;AAAA;AAAA;;AAAA,+CAWrBjB,IAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,gBAAX,EAArB,CAXqB;;AAAA;AAa9BP,kBAAImB,IAAJ,GAAW,EAAEC,OAAOZ,QAAQS,SAAjB,EAAX;AAb8B,+CAcvBf,MAduB;;AAAA;AAAA;AAAA;AAAA,+CAgBvBD,IAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEe,kBAAF,EAArB,CAhBuB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAkBjC;AAnBU,CAAb;;kBAsBevB,I","file":"Auth.js","sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport db from '../db';\r\n\r\nconst Auth = {\r\n  async verifyToken(req, res, next) {\r\n    const token = req.headers['x-access-token'];\r\n\r\n    if (!token) {\r\n      return res.status(403).send({ message: 'No Token Provided' });\r\n    }\r\n    try {\r\n      const decoded = jwt.verify(token, process.env.SECRET);\r\n      const text = 'SELECT * FROM users WHERE email = $1';\r\n      const { rows } = await db.query(text, [decoded.userEmail]);\r\n      if (!rows[0]) {\r\n        return res.status(403).send({ message: 'Session closed' });\r\n      }\r\n      req.user = { email: decoded.userEmail };\r\n      return next();\r\n    } catch (error) {\r\n      return res.status(400).send({ error });\r\n    }\r\n  },\r\n};\r\n\r\nexport default Auth;\r\n"]}